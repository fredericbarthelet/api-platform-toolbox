import { CodeSurfer } from "mdx-deck-code-surfer"
import oceanicNext from "prism-react-renderer/themes/oceanicNext"

# API Platform toolbox

---

<CodeSurfer
  title="Serialisation de base"
  code={require("!raw-loader!./code_exemples/BaseSerializationDog.php").default}
  lang="php"
  showNumbers={false}
  theme={oceanicNext}
  steps={[
      { notes: "Serialisation d'un chien"},
      { lines: [8], notes: "Déclarer la ressource à API Platform" },
      { lines: [9, 10], notes: "Specifier les groupe de serialisation" },
      { lines: [17, 18], notes: "Utiliser des constantes de classe" },
      { lines: [22, 24, 28, 30, 34, 36], notes: "Attribuer les groupes aux attributs" },
  ]}
/>

---

<CodeSurfer
  title="Un champs particulier"
  code={require("!raw-loader!./code_exemples/SwitchInputSerializationDog.php").default}
  lang="php"
  showNumbers={false}
  theme={oceanicNext}
  steps={[
      { range: [38, 42], notes: "Ajout d'une propriété pour un groupe d'utilisateur restreint" },
  ]}
/>

---

<CodeSurfer
  title="La solution"
  code={require("!raw-loader!./code_exemples/SwitchInputSerializationDogSolution.php").default}
  lang="php"
  showNumbers={false}
  theme={oceanicNext}
  steps={[
      { lines: [18], notes: "Nouveau groupe de serialization" },
      { lines: [41, 43], notes: "Ajout de ce groupe à la propriété voulue" },
  ]}
/>

---

<CodeSurfer
  title="Custom SerialiaserContextBuilder"
  code={require("!raw-loader!./code_exemples/ContextBuilder.php").default}
  lang="php"
  showNumbers={false}
  theme={oceanicNext}
  steps={[
      { notes: "Ecriture d'un context builder custom"},
      { lines: [10], notes: "Créer un service qui implémente SerializerContextBuilderInterface" },
      { lines: [30], notes: "Méthode createFromRequest" },
      { range: [31, 34], notes: "Signature de la méthode" },
      { range: [12, 16], lines: [23, 26], notes: "Injection du contextBuilder"},
      { range: [35, 39], notes: "Construction de context classique"},
      { range: [41, 46], notes: "Le context, quesako ?"},
      { lines: [48], notes: "La bonne ressource ?"},
      { lines: [49], notes: "Le bon user ?"},
      { range: [17, 20], lines: [24, 27], notes: "Injection du security"},
      { lines: [50], notes: "Normalisation ou denormalisation ?"},
      { range: [52, 54], notes: "Ajout du groupe de serialisation"},
      { lines: [56], notes: "Retourner le context modifié"},
  ]}
/>